import{_ as e,c as t,a as i,o}from"./app-vAERMEX6.js";const s={};function r(p,a){return o(),t("div",null,a[0]||(a[0]=[i('<h3 id="v8主要的垃圾回收算法" tabindex="-1"><a class="header-anchor" href="#v8主要的垃圾回收算法"><span>V8主要的垃圾回收算法</span></a></h3><p>V8的垃圾回收策略主要基于分代式垃圾回收机制，主要将内存分为<strong>新生代</strong>和<strong>老生代</strong>，V8堆的整体内存空间就是新生代所用内存空间加上老生代的内存空间： <img src="https://upload-images.jianshu.io/upload_images/7209345-9aee047b01b1bc4a.png?imageMogr2/auto-orient/strip|imageView2/2/w/1240" alt="内存.png"></p><p>在分代的基础上，新生代主要通过Scavenge算法进行垃圾回收，在Scavenge具体实现中，主要采用了Cheney算法： 将堆内存一分为二，每一部分空间称为semispace，在这两个semispace空间中只有一个处于使用中称为From空间，另一个处于闲置状态称为To空间： <img src="https://upload-images.jianshu.io/upload_images/7209345-5f16d4382fa725e8.png?imageMogr2/auto-orient/strip|imageView2/2/w/1240" alt="内存示意图.png"> 当我们分配对象时，先是在From空间中进行分配。当开始进行垃圾回收时，会检查From空间中的存活对象，这些存活对象将被复制到To空间中，而非存活对象占用的空间将被释放。完成复制后，From空间和To空间角色互换。简而言之，垃圾回收的过程中就是通过将存活对象在两个semispace空间之间进行复制 当一个对象经过多次复制依然存活时，它将会被认为是生命周期较长随后会被移动到老生代中，采用新的算法进行管理 对象从新生代移动到老生代中的过程称为晋升，晋升的条件主要有两个，一个是对象是否经历过Scavenge回收，一个是To空间的内存占用比超过限制 对于老生代的对象主要采用Mark-Sweep和Mark-Compact相结合的方式进行垃圾回收。Mark-Sweep分为标记和清除两个阶段，在标记阶段遍历堆中的所有对象，并标记活着的对象，随后的清除阶段中只清除没有被标记的对象 <img src="https://upload-images.jianshu.io/upload_images/7209345-94ae52f3da7059c2.png?imageMogr2/auto-orient/strip|imageView2/2/w/1240" alt="Mark-Sweep在老生代空间中标记后的示意图.png"> Mark-Sweep最大的问题是在进行一次被标记清除回收后，内存空间会出现不连续的状态，有可能需要分配一个大对象的情况这时候所有碎片空间都无法满足此次分配就会提前触发垃圾回收，这次回收是不必要的，为了解决这个问题，使用Mark-Compact在对象标记为死亡后，在整理的过程中，将活着的对象往一端移动，移动完成后直接清理掉边界外的内存 <img src="https://upload-images.jianshu.io/upload_images/7209345-aedaa904ea812ab8.png?imageMogr2/auto-orient/strip|imageView2/2/w/1240" alt="Mark-Compact完成标记并移动存活对象后的示意图.png"></p>',3)]))}const n=e(s,[["render",r],["__file","2.html.vue"]]),g=JSON.parse('{"path":"/blogs/js/2.html","title":"V8主要的垃圾回收算法","lang":"en-US","frontmatter":{"title":"V8主要的垃圾回收算法","date":"2021/04/29","tags":["Javascript","NodeJS"],"categories":["js"]},"headers":[{"level":3,"title":"V8主要的垃圾回收算法","slug":"v8主要的垃圾回收算法","link":"#v8主要的垃圾回收算法","children":[]}],"git":{"createdTime":1700040736000,"updatedTime":1700045822000,"contributors":[{"name":"liqiu03","email":"liqiu03@baidu.com","commits":1}]},"filePathRelative":"blogs/js/2.md"}');export{n as comp,g as data};
